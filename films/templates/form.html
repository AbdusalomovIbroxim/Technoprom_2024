{% load static %}
{% load i18n %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
          integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA=="
          crossorigin="anonymous" referrerpolicy="no-referrer"/>

    <link rel="stylesheet" href="{% static 'product/css/product/main.css' %}">
    <link rel="stylesheet" href="{% static 'product/css/product/style.css' %}">
    <link rel="stylesheet" href="{% static 'product/css/product/form.css' %}">
</head>
<body>

{% include 'nav_bar.html' %}
{% include 'messages.html' %}

<style>
    @import url("https://fonts.googleapis.com/css2?family=Poppins:wght@200;300;400;500;600;700&display=swap");
    @import url('https://fonts.googleapis.com/css2?family=Noto+Sans:ital,wght@0,400;0,700;1,400;1,700&display=swap');

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Poppins", sans-serif;
    }

    .preview-image {
        max-width: 200px;
        max-height: 200px;
        margin-bottom: 10px;
    }

    .card {
        border-radius: 10px;
        box-shadow: 0 5px 10px 0 rgba(0, 0, 0, 0.3);
        width: 600px;
        height: 260px;
        background-color: #ffffff;
        padding: 10px 30px 40px;
    }

    .card h3 {
        font-size: 22px;
        font-weight: 600;

    }

    .drop_box {
        margin: 10px 0;
        padding: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        border: 3px dotted #a3a3a3;
        border-radius: 5px;
    }

    .drop_box h4 {
        font-size: 16px;
        font-weight: 400;
        color: #2e2e2e;
    }

    .drop_box p {
        margin-top: 10px;
        margin-bottom: 20px;
        font-size: 12px;
        color: #a3a3a3;
    }

    .btn-choose-file {
        text-decoration: none;
        background-color: #005af0;
        color: #ffffff;
        padding: 10px 20px;
        border: none;
        outline: none;
        transition: 0.3s;
    }

    .btn-choose-file:hover {
        text-decoration: none;
        background-color: #ffffff;
        color: #005af0;
        padding: 10px 20px;
        border: none;
        outline: 1px solid #010101;
    }

    .form input {
        margin: 10px 0;
        width: 100%;
        background-color: #e2e2e2;
        border: none;
        outline: none;
        padding: 12px 20px;
        border-radius: 4px;
    }

</style>

<div class="container">
    <section class="price-form">
        <div class="price__image-form2">
            <img style="" id="bannerImage" src="{% static 'product/images/banners/banner-yangi-uskuna.svg' %}"
                 alt="">
        </div>
        <div class="price__form-form">
            <div class="form-group">
                <label class="form-label">{% translate "Выберите действие:" %}</label>
                <div class="buttons-for-choice-type">
                    <div class="form-check form-check-active">
                        <button type="button" id="buy-button"
                                class="btn btn-primary active">{% translate "Купить" %}</button>
                    </div>
                    <div class="form-check">
                        <button type="button" id="sell-button" class="btn btn-primary"
                                data-authenticated="{{ request.user.is_authenticated }}">{% translate "Продать" %}
                        </button>
                    </div>
                </div>
            </div>

            <form class="custom-form" method="post" action="{% url 'add_film' %}" enctype="multipart/form-data">
                {% csrf_token %}
                <input type="hidden" name="form-name" id="form-name" value="buy">
                <div class="form-group">
                    <label for="name" class="form-label">{% translate "Название" %}:{% for error in form.title.errors %}
                        <div class="error-message">{{ error }}</div>
                    {% endfor %}</label>
                    {{ form.title }}
                    <div id="char-count title" class="char-count__title">0 / 100
                    </div>
                </div>
                <div class="form-group">
                    <label for="description" class="form-label">{% translate "Описание" %}:
                        {% for error in form.description.errors %}
                            <div class="error-message">{{ error }}</div>
                        {% endfor %}</label>
                    {{ form.description }}
                    <div id="char-count description" class="char-count__description">0 / 700</div>
                </div>

                <div class="form-group">
                    <label for="category" class="form-label">{% translate "Категория" %}:
                        {% for error in form.category.errors %}
                            <div class="error-message">{{ error }}</div>
                        {% endfor %}</label>
                    {{ form.category }}
                </div>
                <div class="form-group" id="subcategory-group">
                    <label for="subcategory" class="form-label">{% translate "Субкатегория" %}:
                        {% for error in form.sub_category.errors %}
                            <div class="error-message">{{ error }}</div>
                        {% endfor %}</label>
                    <div id="subcategories-checkboxes"></div>
                </div>
                <div class="form-group" id="tags-group" style="display: block">
                    <label for="tags" class="form-label">{% translate "Теги" %}:{% for error in form.tags.errors %}
                        <div class="error-message">{{ error }}</div>
                    {% endfor %}</label>
                    <div id="tags-checkboxes"></div>
                </div>
                <div class="form-group">
                    <label for="telephone" class="form-label">{% translate "Телефон номер" %}:
                        {% for error in form.telephone.errors %}
                            <div class="error-message">{{ error }}</div>
                        {% endfor %}</label>
                    {#                    {{ form.telephone }}#}
                    <div class="text-16-24 text-black-800 sm:text-14-20 PhoneInput form-group">
                        <div class="PhoneInputCountry relative">
                            <select name="phoneCountry"
                                    aria-label="Phone number country"
                                    class="PhoneInputCountrySelect">
                                <option value="ZZ">International</option>
                                <option value="AF">Afghanistan</option>
                                <option value="AX">Åland Islands</option>
                                <option value="AL">Albania</option>
                                <option value="DZ">Algeria</option>
                                <option value="AS">American Samoa</option>
                                <option value="AD">Andorra</option>
                                <option value="AO">Angola</option>
                                <option value="AI">Anguilla</option>
                                <option value="AG">Antigua and Barbuda</option>
                                <option value="AR">Argentina</option>
                                <option value="AM">Armenia</option>
                                <option value="AW">Aruba</option>
                                <option value="AC">Ascension Island</option>
                                <option value="AU">Australia</option>
                                <option value="AT">Austria</option>
                                <option value="AZ">Azerbaijan</option>
                                <option value="BS">Bahamas</option>
                                <option value="BH">Bahrain</option>
                                <option value="BD">Bangladesh</option>
                                <option value="BB">Barbados</option>
                                <option value="BY">Belarus</option>
                                <option value="BE">Belgium</option>
                                <option value="BZ">Belize</option>
                                <option value="BJ">Benin</option>
                                <option value="BM">Bermuda</option>
                                <option value="BT">Bhutan</option>
                                <option value="BO">Bolivia</option>
                                <option value="BQ">Bonaire, Sint Eustatius and Saba</option>
                                <option value="BA">Bosnia and Herzegovina</option>
                                <option value="BW">Botswana</option>
                                <option value="BR">Brazil</option>
                                <option value="IO">British Indian Ocean Territory</option>
                                <option value="BN">Brunei Darussalam</option>
                                <option value="BG">Bulgaria</option>
                                <option value="BF">Burkina Faso</option>
                                <option value="BI">Burundi</option>
                                <option value="KH">Cambodia</option>
                                <option value="CM">Cameroon</option>
                                <option value="CA">Canada</option>
                                <option value="CV">Cape Verde</option>
                                <option value="KY">Cayman Islands</option>
                                <option value="CF">Central African Republic</option>
                                <option value="TD">Chad</option>
                                <option value="CL">Chile</option>
                                <option value="CN">China</option>
                                <option value="CX">Christmas Island</option>
                                <option value="CC">Cocos (Keeling) Islands</option>
                                <option value="CO">Colombia</option>
                                <option value="KM">Comoros</option>
                                <option value="CG">Congo</option>
                                <option value="CD">Congo, Democratic Republic of the</option>
                                <option value="CK">Cook Islands</option>
                                <option value="CR">Costa Rica</option>
                                <option value="CI">Cote d'Ivoire</option>
                                <option value="HR">Croatia</option>
                                <option value="CU">Cuba</option>
                                <option value="CW">Curaçao</option>
                                <option value="CY">Cyprus</option>
                                <option value="CZ">Czech Republic</option>
                                <option value="DK">Denmark</option>
                                <option value="DJ">Djibouti</option>
                                <option value="DM">Dominica</option>
                                <option value="DO">Dominican Republic</option>
                                <option value="EC">Ecuador</option>
                                <option value="EG">Egypt</option>
                                <option value="SV">El Salvador</option>
                                <option value="GQ">Equatorial Guinea</option>
                                <option value="ER">Eritrea</option>
                                <option value="EE">Estonia</option>
                                <option value="ET">Ethiopia</option>
                                <option value="FK">Falkland Islands</option>
                                <option value="FO">Faroe Islands</option>
                                <option value="FM">Federated States of Micronesia</option>
                                <option value="FJ">Fiji</option>
                                <option value="FI">Finland</option>
                                <option value="FR">France</option>
                                <option value="GF">French Guiana</option>
                                <option value="PF">French Polynesia</option>
                                <option value="GA">Gabon</option>
                                <option value="GM">Gambia</option>
                                <option value="GE">Georgia</option>
                                <option value="DE">Germany</option>
                                <option value="GH">Ghana</option>
                                <option value="GI">Gibraltar</option>
                                <option value="GR">Greece</option>
                                <option value="GL">Greenland</option>
                                <option value="GD">Grenada</option>
                                <option value="GP">Guadeloupe</option>
                                <option value="GU">Guam</option>
                                <option value="GT">Guatemala</option>
                                <option value="GG">Guernsey</option>
                                <option value="GN">Guinea</option>
                                <option value="GW">Guinea-Bissau</option>
                                <option value="GY">Guyana</option>
                                <option value="HT">Haiti</option>
                                <option value="VA">Holy See (Vatican City State)</option>
                                <option value="HN">Honduras</option>
                                <option value="HK">Hong Kong</option>
                                <option value="HU">Hungary</option>
                                <option value="IS">Iceland</option>
                                <option value="IN">India</option>
                                <option value="ID">Indonesia</option>
                                <option value="IR">Iran</option>
                                <option value="IQ">Iraq</option>
                                <option value="IE">Ireland</option>
                                <option value="IM">Isle of Man</option>
                                <option value="IL">Israel</option>
                                <option value="IT">Italy</option>
                                <option value="JM">Jamaica</option>
                                <option value="JP">Japan</option>
                                <option value="JE">Jersey</option>
                                <option value="JO">Jordan</option>
                                <option value="KZ">Kazakhstan</option>
                                <option value="KE">Kenya</option>
                                <option value="KI">Kiribati</option>
                                <option value="XK">Kosovo</option>
                                <option value="KW">Kuwait</option>
                                <option value="KG">Kyrgyzstan</option>
                                <option value="LA">Laos</option>
                                <option value="LV">Latvia</option>
                                <option value="LB">Lebanon</option>
                                <option value="LS">Lesotho</option>
                                <option value="LR">Liberia</option>
                                <option value="LY">Libya</option>
                                <option value="LI">Liechtenstein</option>
                                <option value="LT">Lithuania</option>
                                <option value="LU">Luxembourg</option>
                                <option value="MO">Macao</option>
                                <option value="MG">Madagascar</option>
                                <option value="MW">Malawi</option>
                                <option value="MY">Malaysia</option>
                                <option value="MV">Maldives</option>
                                <option value="ML">Mali</option>
                                <option value="MT">Malta</option>
                                <option value="MH">Marshall Islands</option>
                                <option value="MQ">Martinique</option>
                                <option value="MR">Mauritania</option>
                                <option value="MU">Mauritius</option>
                                <option value="YT">Mayotte</option>
                                <option value="MX">Mexico</option>
                                <option value="MD">Moldova</option>
                                <option value="MC">Monaco</option>
                                <option value="MN">Mongolia</option>
                                <option value="ME">Montenegro</option>
                                <option value="MS">Montserrat</option>
                                <option value="MA">Morocco</option>
                                <option value="MZ">Mozambique</option>
                                <option value="MM">Myanmar</option>
                                <option value="NA">Namibia</option>
                                <option value="NR">Nauru</option>
                                <option value="NP">Nepal</option>
                                <option value="NL">Netherlands</option>
                                <option value="NC">New Caledonia</option>
                                <option value="NZ">New Zealand</option>
                                <option value="NI">Nicaragua</option>
                                <option value="NE">Niger</option>
                                <option value="NG">Nigeria</option>
                                <option value="NU">Niue</option>
                                <option value="NF">Norfolk Island</option>
                                <option value="KP">North Korea</option>
                                <option value="MK">North Macedonia</option>
                                <option value="MP">Northern Mariana Islands</option>
                                <option value="NO">Norway</option>
                                <option value="OM">Oman</option>
                                <option value="PK">Pakistan</option>
                                <option value="PW">Palau</option>
                                <option value="PS">Palestine</option>
                                <option value="PA">Panama</option>
                                <option value="PG">Papua New Guinea</option>
                                <option value="PY">Paraguay</option>
                                <option value="PE">Peru</option>
                                <option value="PH">Philippines</option>
                                <option value="PL">Poland</option>
                                <option value="PT">Portugal</option>
                                <option value="PR">Puerto Rico</option>
                                <option value="QA">Qatar</option>
                                <option value="RE">Reunion</option>
                                <option value="RO">Romania</option>
                                <option value="RU">Russia</option>
                                <option value="RW">Rwanda</option>
                                <option value="BL">Saint Barthélemy</option>
                                <option value="SH">Saint Helena</option>
                                <option value="KN">Saint Kitts and Nevis</option>
                                <option value="LC">Saint Lucia</option>
                                <option value="MF">Saint Martin (French Part)</option>
                                <option value="PM">Saint Pierre and Miquelon</option>
                                <option value="VC">Saint Vincent and the Grenadines</option>
                                <option value="WS">Samoa</option>
                                <option value="SM">San Marino</option>
                                <option value="ST">Sao Tome and Principe</option>
                                <option value="SA">Saudi Arabia</option>
                                <option value="SN">Senegal</option>
                                <option value="RS">Serbia</option>
                                <option value="SC">Seychelles</option>
                                <option value="SL">Sierra Leone</option>
                                <option value="SG">Singapore</option>
                                <option value="SX">Sint Maarten</option>
                                <option value="SK">Slovakia</option>
                                <option value="SI">Slovenia</option>
                                <option value="SB">Solomon Islands</option>
                                <option value="SO">Somalia</option>
                                <option value="ZA">South Africa</option>
                                <option value="KR">South Korea</option>
                                <option value="SS">South Sudan</option>
                                <option value="ES">Spain</option>
                                <option value="LK">Sri Lanka</option>
                                <option value="SD">Sudan</option>
                                <option value="SR">Suriname</option>
                                <option value="SJ">Svalbard and Jan Mayen</option>
                                <option value="SZ">Swaziland</option>
                                <option value="SE">Sweden</option>
                                <option value="CH">Switzerland</option>
                                <option value="SY">Syria</option>
                                <option value="TW">Taiwan</option>
                                <option value="TJ">Tajikistan</option>
                                <option value="TZ">Tanzania</option>
                                <option value="TH">Thailand</option>
                                <option value="TL">Timor-Leste</option>
                                <option value="TG">Togo</option>
                                <option value="TK">Tokelau</option>
                                <option value="TO">Tonga</option>
                                <option value="TT">Trinidad and Tobago</option>
                                <option value="TA">Tristan da Cunha</option>
                                <option value="TN">Tunisia</option>
                                <option value="TR">Turkey</option>
                                <option value="TM">Turkmenistan</option>
                                <option value="TC">Turks and Caicos Islands</option>
                                <option value="TV">Tuvalu</option>
                                <option value="UG">Uganda</option>
                                <option value="UA">Ukraine</option>
                                <option value="AE">United Arab Emirates</option>
                                <option value="GB">United Kingdom</option>
                                <option value="US">United States</option>
                                <option value="UY">Uruguay</option>
                                <option value="UZ">Uzbekistan</option>
                                <option value="VU">Vanuatu</option>
                                <option value="VE">Venezuela</option>
                                <option value="VN">Vietnam</option>
                                <option value="VG">Virgin Islands, British</option>
                                <option value="VI">Virgin Islands, U.S.</option>
                                <option value="WF">Wallis and Futuna</option>
                                <option value="EH">Western Sahara</option>
                                <option value="YE">Yemen</option>
                                <option value="ZM">Zambia</option>
                                <option value="ZW">Zimbabwe</option>
                            </select>
                            <div aria-hidden="true" class="PhoneInputCountryIcon">
                                <img class="PhoneInputCountryIconImg"
                                     src="https://textilefinds.com/images/country-flags/UZ.png" alt="Uzbekistan Flag">
                            </div>
                            <div class="PhoneInputCountrySelectArrow"></div>
                        </div>
                        <input type="tel" name="telephone" class="form-input PhoneInputInput"
                               placeholder="+998 123 45 67"
                               id="id_telephone">
                    </div>
                </div>


                <div class="form-group">
                    <label for="telegram" class="form-label">{% translate "Телеграмм" %}:
                        {% for error in form.telegram.errors %}
                            <div class="error-message">{{ error }}</div>
                        {% endfor %}</label>
                    <div class="relative">
                        <span
                                class="absolute bottom-0 left-0 top-0 flex items-center border-r border-gray-200 px-2">
                            <svg
                                    width="24" height="24" viewBox="0 0 24 24" fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 1C5.92339 1 1 5.96774 1 12C1 18.0766 5.92339 23 12 23C18.0323 23 23 18.0766 23 12C23 5.96774 18.0323 1 12 1ZM17.0565 8.49597C16.9234 10.2258 16.2137 14.4839 15.8145 16.3911C15.6815 17.2339 15.371 17.5 15.0605 17.5444C14.4395 17.5887 13.9516 17.1008 13.3306 16.7016C12.3548 16.0806 11.8226 15.6815 10.8911 15.0605C9.78226 14.3508 10.4919 13.9516 11.1129 13.3306C11.2903 13.1532 14.0847 10.5806 14.129 10.3589C14.1734 10.3145 14.1734 10.2258 14.0847 10.1371C14.0403 10.0927 13.9516 10.1371 13.8629 10.1371C13.7742 10.1371 12.2218 11.1573 9.25 13.1976C8.80645 13.5081 8.40726 13.6411 8.05242 13.6411C7.65323 13.6411 6.89919 13.4194 6.32258 13.2419C5.65726 13.0202 5.08065 12.8871 5.125 12.5323C5.16935 12.3105 5.43548 12.1331 5.96774 11.9113C9.16129 10.4919 11.2903 9.60484 12.3548 9.16129C15.4153 7.875 16.0806 7.65323 16.4798 7.65323C16.5685 7.65323 16.7903 7.65323 16.9234 7.78629C16.9677 7.83065 17.0565 7.96371 17.0565 8.05242C17.1008 8.22984 17.1008 8.3629 17.0565 8.49597Z"
                                      fill="#9CA3AF"></path>
                            </svg>
                        </span>
                        {{ form.telegram }}
                    </div>
                </div>

                <div class="form-group" id="country-group">
                    <label for="id_country" class="form-label">{% translate "Страна" %}:
                        {% for error in form.country.errors %}
                            <div class="error-message">{{ error }}</div>
                        {% endfor %}</label>
                    {{ form.country }}
                </div>

                <div class="form-group" id="city-group">
                    <label for="city" class="form-label">{% translate "Город" %}: {% for error in form.city.errors %}
                        <div class="error-message">{{ error }}</div>
                    {% endfor %}</label>
                    {{ form.city }}
                </div>

                <div class="form-group" id="image-group">
                    <div class="image-form">
                        <label class="form-label">{% translate "Фотографии" %}</label>
                        <label class="form-label"
                               style="font-size: 16px; padding-left: 15px">{% translate " (Eng optimal product rasmini tanlang)" %}</label>
                    </div>

                    <div class="container">
                        <h3>Upload Files</h3>
                        <div class="drop_box">
                            <header>
                                <h4>Select Files here</h4>
                            </header>
                            <div id="selectedFiles"></div>
                            <p>Files Supported: Image (JPEG, JPG, PNG)</p>
                            {#                            {{ form.about_us }}#}
                            <input type="file" hidden accept=".png, .jpg, .jpeg" id="fileInput1"
                                   style="display:none;" name="images">
                            <input type="file" hidden accept=".png, .jpg, .jpeg" id="fileInput2"
                                   style="display:none;" name="images">
                            <input type="file" hidden accept=".png, .jpg, .jpeg" id="fileInput3"
                                   style="display:none;" name="images">
                            <button type="button" class="btn-choose-file">Choose Files</button>
                        </div>
                    </div>

                </div>
                <div class="form-group" id="price-group">
                    <label class="form-label">{% translate "Цена" %}:</label>
                    {{ form.price }}
                </div>
                <div class="form-group" id="is_price_negotiable-group">
                    <label class="form-label">{% translate "Договорная" %}:</label>
                    {{ form.is_price_negotiable }}
                </div>
                <button type="submit" class="form-button">{% translate "Отправить" %}</button>
            </form>

        </div>
    </section>
</div>

{% include 'footer.html' %}

</body>

<script src="{% static "product/js/style.js" %}"></script>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>


<script>
    const dropArea = document.querySelector(".drop_box");
    const button = dropArea.querySelector(".btn-choose-file");
    const fileInputs = [
        dropArea.querySelector("#fileInput1"),
        dropArea.querySelector("#fileInput2"),
        dropArea.querySelector("#fileInput3")
    ];
    const selectedFiles = document.querySelector("#selectedFiles");

    let currentInputIndex = 0;

    // Функция для отправки файла на сервер
    function sendFile(file) {
        // Здесь можно добавить логику отправки файла на сервер
        // Например, с помощью AJAX запроса или использования Fetch API
        console.log("Отправка файла:", file.name);
    }

    // Функция для обработки изменения текущего input
    function handleInputChange(e) {
        const file = e.target.files[0]; // Получаем только первый файл из выборки

        if (file.size <= 5 * 1024 * 1024) { // Проверяем размер файла (в байтах)
            const fileName = document.createElement("div");
            fileName.textContent = file.name;
            selectedFiles.appendChild(fileName); // Добавляем имя файла в список выбранных файлов
            sendFile(file); // Отправляем файл на сервер
        } else {
            alert("Файл '" + file.name + "' превышает максимальный размер 5 МБ и не будет отправлен.");
        }

        // Переходим к следующему инпуту или завершаем, если это последний инпут
        currentInputIndex++;
        {#if (currentInputIndex < fileInputs.length) {#}
        {#    fileInputs[currentInputIndex].click(); // Вызываем клик для следующего инпута#}
        {# }#}
    }

    // Назначаем обработчики для каждого input
    fileInputs.forEach(input => {
        input.addEventListener("change", handleInputChange);
    });

    // Назначаем обработчик для кнопки выбора файла
    button.onclick = () => {
        {#currentInputIndex = 0; // Сбрасываем индекс текущего инпута#}
        fileInputs[currentInputIndex].click(); // Вызываем клик для первого инпута
    };

</script>


<script>
    $(document).ready(function () {
        const categorySelect = $('#id_category');
        const subcategoryGroup = $('#subcategory-group');
        const subcategoryCheckboxes = $('#subcategories-checkboxes');
        const tagsGroup = $('#tags-group');
        const tagsCheckboxes = $('#tags-checkboxes');
        const pathParts = window.location.pathname.split('/');
        const language = pathParts[1] ? pathParts[1] : 'ru';
        const placeholderText = {
            'ru': {
                'title': "Я ищу термопластичную машину",
                'description': "должен производить продукт по 150 гр.",
            },
            'en': {
                'title': "I'm looking for a thermoplastic machine",
                'description': 'Enter description',
            },
            "uz": {
                'title': "Termoplastavtomat qidiryapman",
                'description': "150 gr lik mahsulot chiqarishi kerak",
            }
        };
        const languageText = {
            'ru': 'Выберите категорию',
            'en': 'Select a category',
            'uz': 'Ketegoriyani tanlang',
        };

        $('#id_title').attr('placeholder', placeholderText[language]['title']);
        $('#id_description').attr('placeholder', placeholderText[language]['description']);
        categorySelect.find('option[value=""]').text(languageText[language]);

        function loadSubcategories() {
            const selectedCategoryId = categorySelect.val();

            subcategoryCheckboxes.empty();

            if (selectedCategoryId) {
                subcategoryGroup.show();
                tagsGroup.hide()
                $.ajax({
                    url: `/${language}/related_to_it/?category_id=${selectedCategoryId}`,
                    dataType: 'json',
                    success: function (data) {
                        console.log(data.subcategories);

                        $.each(data.subcategories, function (key, value) {
                            const checkboxContainer = $('<div>').addClass('cat action');
                            const label = $('<label>');
                            const checkbox = $('<input type="checkbox">')
                                .attr('id', `subcategory-${key}`)
                                .attr('name', 'subcategories')
                                .attr('value', key)
                                .appendTo(label);

                            label.append(checkbox);
                            label.append(`<span>${value}</span>`);
                            checkboxContainer.append(label);
                            subcategoryCheckboxes.append(checkboxContainer);
                        });
                    }
                });
            } else {
                subcategoryGroup.hide();
                tagsGroup.hide()
            }
        }

        categorySelect.change(loadSubcategories);
        loadSubcategories();

        function getSelectedSubcategories() {
            const selectedSubcategories = [];
            subcategoryCheckboxes.find('input[name="subcategories"]:checked').each(function () {
                selectedSubcategories.push($(this).val());
            });
            return selectedSubcategories;
        }

        function loadTags() {
            const selectedSubcategories = getSelectedSubcategories();

            tagsCheckboxes.empty();

            if (selectedSubcategories.length > 0) {
                selectedSubcategories.forEach(function (subcategoryId) {
                    $.ajax({
                        url: `/${language}/related_to_it/?subcategory_id=${subcategoryId}`,
                        dataType: 'json',
                        success: function (data) {
                            console.log(`Tags for Subcategory ${subcategoryId}:`, data.tags);

                            $.each(data.tags, function (key, value) {
                                const checkboxContainer = $('<div>').addClass('cat action');
                                const label = $('<label>');
                                const checkbox = $('<input type="checkbox">')
                                    .attr('id', `tag-${key}`)
                                    .attr('name', 'tags')
                                    .attr('value', key)
                                    .appendTo(label);

                                label.append(checkbox);
                                label.append(`<span>${value}</span>`);
                                checkboxContainer.append(label);
                                tagsCheckboxes.append(checkboxContainer);
                            });
                        }
                    });
                });

                tagsGroup.show();
            } else {
                tagsGroup.hide();
            }
        }

        subcategoryCheckboxes.on('change', loadTags);
        loadTags();
    });

</script>


<script>
    $(document).ready(function () {
        // Функция, которая будет вызываться при изменении поля "Страна"
        $("#id_country").change(function () {
            // Получаем значение выбранной страны
            var selectedCountry = $(this).val();

            // Если выбран Узбекистан, показываем поле "Город", иначе скрываем его
            if (selectedCountry === "1") {
                $("#city-group").show();
            } else {
                $("#city-group").hide();
            }
        });

        // Инициализация состояния поля "Город" при загрузке страницы
        if ($("#country").val() === "1") {
            $("#city-group").show();
        } else {
            $("#city-group").hide();
        }
    });
</script>


<script>
    document.addEventListener('DOMContentLoaded', function () {
        const buyButton = document.getElementById('buy-button');
        const sellButton = document.getElementById('sell-button');
        const formNameInput = document.getElementById('form-name');


        buyButton.addEventListener('click', function () {
            if (!buyButton.classList.contains("active")) {
                buyButton.classList.add("active");
                sellButton.classList.remove("active");
                formNameInput.value = "buy";
            }
        });
        sellButton.addEventListener('click', function () {
            if (!sellButton.classList.contains("active")) {

                const isAuthenticated = sellButton.getAttribute('data-authenticated');
                const userBall = {{ request.user.currency|default:0|stringformat:"s"|safe }};
                console.log(userBall)
                if (isAuthenticated === "True" && userBall >= 10) {
                    sellButton.classList.add("active");
                    buyButton.classList.remove("active");
                    formNameInput.value = "sell";
                } else if (isAuthenticated === "True" && userBall < 10) {
                    const messageData = "You need at least 10 balls to perform the 'sell' action";
                    alert(messageData)
                    window.location.href = "{% url 'myaccount' %}";
                } else {
                    window.location.href = "{% url 'login' %}";
                }
            }
        });
    });
</script>
<script>
    $(document).ready(function () {
        $('#image-group, #price-group, #is_price_negotiable-group').hide();

        $('#buy-button').click(function () {
            $('#price-group').hide();
            $('#is_price_negotiable-group').hide();
            $('#image-group').hide();
        });

        $('#sell-button').click(function () {
            $('#image-group').show();
            $('#price-group').show();
            $('#is_price_negotiable-group').show();

        });

        $('#id_is_price_negotiable').change(function () {
            togglePriceField(this.checked);
        });

        function togglePriceField(isPriceNegotiable) {
            if (isPriceNegotiable) {
                $('#id_price').prop('disabled', true).val('');
            } else {
                $('#id_price').prop('disabled', false);
            }
        }
    });
</script>

<script>
    const imageInput = document.getElementById('id_image');
    const resetButton = document.getElementById('reset-image');

    resetButton.addEventListener('click', function () {
        imageInput.value = '';

        imageInput.style.display = 'none';
        imageInput.offsetHeight;
        imageInput.style.display = 'block';
    });
</script>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const descriptionField = document.getElementById('id_description');
        const charCount = document.getElementById('char-count description');

        descriptionField.addEventListener('input', function () {
            const currentLength = descriptionField.value.length;
            charCount.textContent = currentLength + ' / 700';

            // Если текст приближается к лимиту (например, 750 символов),
            // можно изменить цвет на красный
            if (currentLength >= 700) {
                charCount.style.color = 'red';
            } else {
                charCount.style.color = ''; // Сбросить цвет, если не приближается к лимиту
            }
        });
    });
</script>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const titleField = document.getElementById('{{ form.title.id_for_label }}');
        const charCount = document.getElementById('char-count title');

        titleField.addEventListener('input', function () {
            const currentLength = titleField.value.length;
            charCount.textContent = currentLength + ' / 100';

            // Если текст приближается к лимиту (например, 90 символов),
            // можно изменить цвет на красный
            if (currentLength >= 90) {
                charCount.style.color = 'red';
            } else {
                charCount.style.color = ''; // Сбросить цвет, если не приближается к лимиту
            }
        });
    });
</script>


</html>